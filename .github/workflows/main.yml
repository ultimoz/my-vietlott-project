name: Daily Vietlott Prediction AI

# Trigger: Ch·∫°y v√†o 17:30 VN (10:30 UTC) m·ªói Th·ª© 3, 5, 7 (ng√†y quay th∆∞·ªüng)
# Ho·∫∑c ch·∫°y th·ªß c√¥ng khi b·∫°n b·∫•m n√∫t tr√™n web Github
on:
  schedule:
    - cron: '30 10 * * 2,4,6' 
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build-and-predict:
    runs-on: ubuntu-latest

    steps:
    # 1. T·∫£i m√£ ngu·ªìn v·ªÅ m√°y ·∫£o
    - name: Checkout code
      uses: actions/checkout@v3

    # 2. C√†i ƒë·∫∑t Python
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    # 3. C√†i ƒë·∫∑t th∆∞ vi·ªán (Cache ƒë·ªÉ ch·∫°y nhanh h∆°n l·∫ßn sau)
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # 4. Ch·∫°y m√¥ h√¨nh AI
    - name: Run Prediction Model
      run: python scripts/predict.py

    # 5. Commit v√† Push k·∫øt qu·∫£ m·ªõi l√™n Github
    - name: Commit and Push results
      run: |
        git config --global user.name 'Vietlott-AI-Bot'
        git config --global user.email 'bot@vietlott-ai.com'
        git add data/latest_prediction.json
        git commit -m "ü§ñ AI Auto-Update: Prediction for $(date +'%Y-%m-%d')" || exit 0
        git push
